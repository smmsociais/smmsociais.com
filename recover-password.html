<!DOCTYPE html>
<html id="theme_23" lang="pt-BR">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Recuperar Senha - SMM SOCIAIS</title>
    <link rel="stylesheet" type="text/css" href="https://storage.perfectcdn.com/global/tad3g2kcwfrtr6yi.css">
    <link rel="stylesheet" type="text/css" href="https://storage.perfectcdn.com/ahnerj/2pcamz1sqmak1hf9.css">
    <!-- Adicionando Toastr para notificações -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
</head>

<body class="body  body-public">
    <div class="wrapper  wrapper-navbar ">
        <div id="block_49">
            <div class="block-wrapper">
                <div class="component_navbar ">
                    <div class="component-navbar__wrapper">
                        <div
                            class="component-navbar component-navbar__navbar-public component-navbar__navbar-public-padding editor__component-wrapper ">
                            <div>
                                <nav class="navbar navbar-expand-lg navbar-light navbar-rows">
                                    <div class="navbar-public__header">
                                        <div class="sidebar-block__top-brand">
                                            <a href="/" class="component-navbar-brand component-navbar-public-brand">
                                                <h1><span style="color: var(--color-id-117)">SMM SOCIAIS</span></h1>
                                            </a>
                                        </div>
                                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                                            data-target="#navbar-collapse-49" aria-controls="navbar-collapse-49"
                                            aria-expanded="false" aria-label="Toggle navigation">
                                            <span class="navbar-burger">
                                                <span class="navbar-burger-line"></span>
                                            </span>
                                        </button>
                                    </div>
                                    <div class="collapse navbar-collapse" id="navbar-collapse-49">
                                        <div class="d-flex flex-wrap component-navbar-collapse">
                                            <ul class="navbar-nav">
                                                <li
                                                    class="nav-item component-navbar-nav-item component-navbar-public-nav-item nav-item-height">
                                                    <a class="component-navbar-nav-link component-navbar-nav-link__navbar-public "
                                                        href="/"> Fazer Login</a>
                                                </li>
                                                <li
                                                    class="nav-item component-navbar-nav-item component-navbar-public-nav-item nav-item-height">
                                                    <a class="component-navbar-nav-link component-navbar-nav-link__navbar-public "
                                                        href="/servicos"> Serviços</a>
                                                </li>
                                                <li
                                                    class="nav-item component-navbar-nav-item component-navbar-public-nav-item nav-item-height">
                                                    <a class="component-navbar-nav-link component-navbar-nav-link__navbar-public "
                                                        href="/signup"> Criar Conta</a>
                                                </li>
                                                <li
                                                    class="nav-item component-navbar-nav-item component-navbar-public-nav-item nav-item-height">
                                                    <a class="component-navbar-nav-link component-navbar-nav-link__navbar-public component-navbar-nav-link-active__navbar-public"
                                                        href="/termos"> Termos</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="wrapper-content">
            <div class="wrapper-content__header">
            </div>
            <div class="wrapper-content__body">
                <!-- Main variables *content* -->
                <div id="block_44">
                    <div class="block-bg">
                        <div class="bg-image"></div>
                    </div>
                    <div class="container">
                        <div class="reset-password-form">
                            <div class="row reset-password-form__alignment">
                                <div class="col-lg-4">
                                    <div class="component_card">
                                        <div class="card">
                                            <form id="recoverPasswordForm" method="post">
                                                <div class="component_form_group">
                                                    <div class="">
                                                        <div class="form-group">
                                                            <label for="email" class="control-label">E-mail</label>
                                                            <input type="email" class="form-control" id="email"
                                                                name="email" required>
                                                        </div>
                                                        <div class="component_button_submit">
                                                            <div class="">
                                                                <button type="submit" id="submitBtn"
                                                                    class="btn btn-block btn-big-primary">
                                                                    <span id="submitText">Enviar</span>
                                                                    <span id="loadingSpinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="wrapper-content__footer">
                <div id="block_66">
                    <div class="footer ">
                        <div class="component_footer_single_line">
                            <div class="component-footer">
                                <div class="component-footer__public">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="component-footer__public-copyright">
                                                    <p class="text-center"><span style="text-align: CENTER">© 2025,
                                                            SMMSociais.</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notifications wrapper -->
    <div id="notify-wrapper" class="alert alert-success mb-3 hidden" style="display: none;"></div>

    <!-- Adicionando Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Adicionando Toastr para notificações -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <script type="text/javascript">
        (function () {
            // Função utilitária para encontrar o alvo do botão (data-target ou aria-controls)
            function resolveTarget(button) {
                const targetSelector = button.getAttribute('data-target') || button.getAttribute('data-bs-target') || ('#' + (button.getAttribute('aria-controls') || ''));
                if (!targetSelector) return null;
                try {
                    return document.querySelector(targetSelector);
                } catch (e) {
                    return null;
                }
            }

            // Inicializa todos os togglers de navbar existentes
            function initNavTogglers() {
                const togglers = document.querySelectorAll('.navbar-toggler');
                togglers.forEach(btn => {
                    const target = resolveTarget(btn);
                    if (!target) return;

                    // Garantir que o botão tenha type="button" para evitar submit acidental
                    if (!btn.hasAttribute('type')) btn.setAttribute('type', 'button');

                    // Evitar duplicar event listeners
                    if (btn.__nav_init) return;
                    btn.__nav_init = true;

                    btn.addEventListener('click', function (e) {
                        e.preventDefault();
                        const isShown = target.classList.contains('show');
                        if (isShown) {
                            target.classList.remove('show');
                            btn.classList.remove('collapsed');
                            btn.setAttribute('aria-expanded', 'false');
                        } else {
                            target.classList.add('show');
                            btn.classList.add('collapsed');
                            btn.setAttribute('aria-expanded', 'true');
                        }
                    });

                    // Fechar ao clicar fora (somente se estiver aberto)
                    document.addEventListener('click', function (ev) {
                        if (!target.classList.contains('show')) return;
                        if (btn.contains(ev.target) || target.contains(ev.target)) return;
                        target.classList.remove('show');
                        btn.setAttribute('aria-expanded', 'false');
                    });

                    // Fechar ao pressionar ESC
                    document.addEventListener('keydown', function (ev) {
                        if (ev.key === 'Escape' && target.classList.contains('show')) {
                            target.classList.remove('show');
                            btn.setAttribute('aria-expanded', 'false');
                        }
                    });

                    // Ao redimensionar para telas grandes, garantir menu fechado
                    window.addEventListener('resize', function () {
                        if (window.innerWidth >= 992 && target.classList.contains('show')) {
                            target.classList.remove('show');
                            btn.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }

            // Configurar Toastr
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            };

            // Função para enviar requisição de recuperação de senha
            async function handleRecoverPassword(event) {
                event.preventDefault();
                
                const emailInput = document.getElementById('email');
                const submitBtn = document.getElementById('submitBtn');
                const submitText = document.getElementById('submitText');
                const loadingSpinner = document.getElementById('loadingSpinner');
                const email = emailInput.value.trim();
                
                // Validação básica
                if (!email) {
                    toastr.error('Por favor, insira seu e-mail.');
                    emailInput.focus();
                    return;
                }
                
                // Validação de formato de e-mail
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    toastr.error('Por favor, insira um e-mail válido.');
                    emailInput.focus();
                    return;
                }
                
                // Desabilitar botão e mostrar loading
                submitBtn.disabled = true;
                submitText.textContent = 'Enviando...';
                loadingSpinner.style.display = 'inline-block';
                
                try {
                    const response = await fetch('https://smmsociais.com/api/recover-password', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ email: email.toLowerCase() })
                    });
                    
                    const data = await response.json();
                    
                    if (response.ok) {
                        toastr.success(data.message || 'Link de recuperação enviado com sucesso! Verifique seu e-mail.');
                        emailInput.value = '';
                    } else {
                        toastr.error(data.error || 'Erro ao enviar link de recuperação.');
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    toastr.error('Erro de conexão. Tente novamente.');
                } finally {
                    // Reativar botão
                    submitBtn.disabled = false;
                    submitText.textContent = 'Enviar';
                    loadingSpinner.style.display = 'none';
                }
            }

            // Inicializar eventos quando o DOM estiver carregado
            function init() {
                // Inicializar navbar
                initNavTogglers();
                
                // Adicionar evento de submit ao formulário
                const recoverPasswordForm = document.getElementById('recoverPasswordForm');
                if (recoverPasswordForm) {
                    recoverPasswordForm.addEventListener('submit', handleRecoverPassword);
                }
                
                // Adicionar evento de tecla Enter no campo de e-mail
                const emailInput = document.getElementById('email');
                if (emailInput) {
                    emailInput.addEventListener('keypress', function(event) {
                        if (event.key === 'Enter') {
                            event.preventDefault();
                            handleRecoverPassword(event);
                        }
                    });
                }
            }

            // Inicializar no DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
</body>

</html>
